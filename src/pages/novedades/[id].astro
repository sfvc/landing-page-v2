---
import "../../styles/global.css";
import { getDatos, getDatosNovedades } from "../../util/obtenerDatos.astro";
import { catamarcaApi } from "../../api/catamarcaApi";
import Footer from "../../components/footer.astro";
import Navbar from "../../components/navbar.astro";

type Novedad = {
    id: string | number;
    titulo: string;
    descripcion: string;
    icono: string;
    contenido: string;
    fecha: string;
    imagen: string;
};

const datosCompletos = await getDatos();
const { novedad }: { novedad: Novedad } = Astro.props;
const imagenUrl = `${catamarcaApi.defaults.baseURL}/assets/${novedad.imagen}`;

export async function getStaticPaths() {
    const novedades = await getDatosNovedades();
    return novedades.map((novedad: any) => ({
        params: { id: novedad.id.toString() },
        props: { novedad },
    }));
}
---

<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{novedad.titulo} - {datosCompletos.nombre}</title>
        <link rel="icon" type="image/png" href="/favicon_CATACAPI.png" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
        />
        <script src="../../scripts/main.js"></script>
    </head>

    <body class="bg-gray-50 text-gray-800 font-sans">
        <Navbar />

        <div class="bg-gray-100 py-3 border-b">
            <div class="container mx-auto px-4 text-sm text-gray-600">
                <a href="/" class="colorPrincipalTextoHover">Inicio</a>
                <span class="mx-2">/</span>
                <a href="/#novedades" class="colorPrincipalTextoHover"
                    >Novedades</a
                >
                <span class="mx-2">/</span>
                <span class="text-gray-800">{novedad.titulo}</span>
            </div>
        </div>

        <!-- Contenido principal -->
        <main class="container mx-auto px-4 py-12">
            <div class="max-w-4xl mx-auto animate__animated animate__fadeIn">
                <span
                    class="inline-block bg-green-100 text-green-800 text-sm font-semibold px-4 py-1 rounded-full mb-4 shadow-sm"
                >
                    <i class="fas fa-bolt mr-1"></i> Novedad
                </span>

                <h1
                    class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-6 leading-tight tracking-tight"
                >
                    {novedad.titulo}
                </h1>

                <div class="flex items-center text-sm text-gray-500 mb-6">
                    <i class="far fa-clock mr-2"></i> 5 min de lectura
                    <span class="mx-2">â€¢</span>
                    <span>{novedad.fecha}</span>
                </div>

                <div
                    class="mb-8 animate__animated animate__fadeIn"
                    style="animation-delay: 0.2s"
                >
                    <img
                        src={imagenUrl}
                        alt={novedad.titulo}
                        class="w-full aspect-video object-cover rounded-2xl shadow-lg transition duration-300 hover:shadow-xl"
                    />
                </div>

                <div
                    class="mb-8 animate__animated animate__fadeIn"
                    style="animation-delay: 0.3s"
                >
                    <blockquote
                        class="text-lg text-gray-700 font-medium border-l-4 border-green-500 pl-4 italic bg-green-50 py-3 rounded-md"
                    >
                        {novedad.descripcion}
                    </blockquote>
                </div>

                <div
                    class="prose prose-lg max-w-none animate__animated animate__fadeIn"
                    style="animation-delay: 0.4s"
                >
                    <Fragment set:html={novedad.contenido} />
                </div>

                <div class="mt-16 pt-8 border-t border-gray-300">
                    <div class="flex justify-end">
                        <a
                            href="/#novedades"
                            class="inline-flex items-center text-sm font-semibold colorPrincipalTexto colorPrincipalTextoHover transition duration-200"
                        >
                            <i class="fas fa-arrow-left mr-2"></i> Volver a novedades
                        </a>
                    </div>
                </div>
            </div>
        </main>

        <Footer />
    </body>
</html>
